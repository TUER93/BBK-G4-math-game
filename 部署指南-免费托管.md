# 🚀 BBK数学答题王 - 免费托管部署完整指南

## 📋 准备工作

✅ 代码已推送到 GitHub  
✅ 已配置 railway.toml  
✅ package.json 已正确配置

---

## 方案一：Railway 部署（推荐⭐⭐⭐⭐⭐）

### 为什么选择 Railway？
- ✅ **完全免费**（每月500小时，足够使用）
- ✅ **永久域名**（.railway.app）
- ✅ **数据持久化**（JSON文件自动保存）
- ✅ **5分钟部署**
- ✅ **自动HTTPS**

### 详细步骤

#### 1️⃣ 注册 Railway

1. 打开浏览器访问：https://railway.app
2. 点击右上角 **"Login"**
3. 选择 **"Login with GitHub"**（推荐）
4. 授权 Railway 访问你的 GitHub

#### 2️⃣ 创建新项目

1. 登录后，点击 **"New Project"** 或 **"+ New"**
2. 选择 **"Deploy from GitHub repo"**
3. 如果是第一次使用，点击 **"Configure GitHub App"**
4. 选择 **"All repositories"** 或只选择 `bbk game` 仓库
5. 保存并返回 Railway

#### 3️⃣ 选择仓库部署

1. 在项目列表中找到你的仓库名（bbk game）
2. 点击仓库名称
3. Railway 会自动检测到这是一个 Node.js 项目
4. 点击 **"Deploy Now"** 或 **"Add variables"**（可选）

#### 4️⃣ 配置环境变量（可选）

点击项目 → **"Variables"** 标签页，添加：

```
PORT=3000
NODE_ENV=production
```

**注意**：通常不需要设置 PORT，Railway 会自动分配。

#### 5️⃣ 等待部署完成

- 查看 **"Deployments"** 标签页
- 等待状态变为 **"Success"** ✅（约1-3分钟）
- 查看构建日志确认没有错误

#### 6️⃣ 生成公开域名

1. 点击项目卡片
2. 进入 **"Settings"** 标签页
3. 找到 **"Networking"** 或 **"Domains"** 部分
4. 点击 **"Generate Domain"**
5. 获得域名，例如：`https://bbk-game-production.up.railway.app`

#### 7️⃣ 配置数据持久化（重要！）

1. 在项目页面，点击 **"Settings"**
2. 找到 **"Volumes"** 或 **"Storage"**
3. 点击 **"New Volume"**
4. 挂载路径填写：`/app`（或留空使用默认）
5. 点击 **"Add"**

这样可以确保 `data.json`、`questions.json`、`students.json` 不会丢失！

#### 8️⃣ 访问你的网站

复制生成的域名，在浏览器打开：
```
https://你的项目名.up.railway.app
```

🎉 **部署完成！**

---

## 方案二：Render 部署（备选⭐⭐⭐⭐）

### 为什么选择 Render？
- ✅ **完全免费**
- ✅ **永久域名**（.onrender.com）
- ✅ **自动HTTPS**
- ✅ **支持持久化磁盘**

### 详细步骤

#### 1️⃣ 注册 Render

1. 访问：https://render.com
2. 点击 **"Get Started"**
3. 选择 **"Sign in with GitHub"**
4. 授权 Render

#### 2️⃣ 创建 Web Service

1. 点击 **"New +"** → **"Web Service"**
2. 选择 **"Build and deploy from a Git repository"**
3. 点击 **"Connect account"** 连接 GitHub
4. 选择你的 `bbk game` 仓库
5. 点击 **"Connect"**

#### 3️⃣ 配置服务

填写以下信息：

- **Name**: `bbk-math-game`（或自定义）
- **Region**: 选择离你最近的（推荐 Singapore）
- **Branch**: `main`
- **Root Directory**: 留空
- **Runtime**: **Node**
- **Build Command**: `npm install`
- **Start Command**: `npm start`

#### 4️⃣ 选择免费计划

- **Instance Type**: 选择 **"Free"**
- 免费计划限制：
  - 休眠15分钟无访问后
  - 每月750小时

#### 5️⃣ 添加环境变量（可选）

在 **"Environment Variables"** 部分：
```
NODE_ENV=production
```

#### 6️⃣ 配置持久化存储

1. 点击 **"Add Disk"**
2. **Name**: `data`
3. **Mount Path**: `/opt/render/project/src`
4. **Size**: 1GB（免费）

#### 7️⃣ 部署

点击 **"Create Web Service"**

等待部署完成（约3-5分钟），访问：
```
https://bbk-math-game.onrender.com
```

---

## 方案三：Vercel 部署（简单但需要配置数据库）

### 注意事项
⚠️ Vercel 是无服务器平台，**不支持文件存储**，需要配置数据库。

### 快速步骤

#### 1️⃣ 安装 Vercel CLI

```bash
npm install -g vercel
```

#### 2️⃣ 登录

```bash
vercel login
```

#### 3️⃣ 部署

```bash
cd "c:/Users/17227/CodeBuddy/bbk game"
vercel
```

按提示操作即可。

#### 4️⃣ 配置数据库（必需）

由于 Vercel 不支持文件存储，需要：

**选项1：使用 Vercel KV（Redis）**
```bash
vercel env add
```

**选项2：使用 MongoDB Atlas**
1. 注册 https://www.mongodb.com/cloud/atlas
2. 创建免费集群
3. 获取连接字符串
4. 修改代码使用 MongoDB

---

## 方案四：Glitch 部署（最简单）

### 为什么选择 Glitch？
- ✅ **无需 Git**
- ✅ **在线编辑**
- ✅ **即时部署**
- ❌ 国内访问较慢

### 详细步骤

#### 1️⃣ 访问 Glitch

打开：https://glitch.com

#### 2️⃣ 创建项目

1. 点击 **"New Project"**
2. 选择 **"Import from GitHub"**
3. 输入你的 GitHub 仓库地址：
   ```
   https://github.com/你的用户名/bbk-game
   ```

#### 3️⃣ 等待导入

Glitch 会自动：
- 克隆代码
- 安装依赖
- 启动服务

#### 4️⃣ 获取域名

项目地址：
```
https://你的项目名.glitch.me
```

---

## 📊 平台对比

| 平台 | 部署难度 | 域名 | 数据持久化 | 免费额度 | 推荐指数 |
|------|----------|------|-----------|----------|----------|
| **Railway** | ⭐⭐ | `.railway.app` | ✅ | 500h/月 | ⭐⭐⭐⭐⭐ |
| **Render** | ⭐⭐ | `.onrender.com` | ✅ | 750h/月 | ⭐⭐⭐⭐ |
| **Vercel** | ⭐⭐⭐ | `.vercel.app` | ❌ 需数据库 | 无限 | ⭐⭐⭐ |
| **Glitch** | ⭐ | `.glitch.me` | ✅ | 无限 | ⭐⭐⭐⭐ |

---

## 🔧 部署后配置

### 1. 更新前端 API 地址

部署完成后，前端会自动使用正确的服务器地址（已在 `app.js` 中配置）：

```javascript
const SERVER_URL = window.location.hostname === 'localhost' 
    ? 'http://localhost:3000'
    : window.location.origin;
```

### 2. 测试功能

访问你的网站，测试：
- ✅ 登录功能
- ✅ 答题功能
- ✅ 数据保存（刷新页面后数据是否还在）
- ✅ 音效播放

### 3. 查看日志

**Railway**:
- 项目页面 → "Deployments" → 点击部署记录 → 查看 "Logs"

**Render**:
- 项目页面 → "Logs" 标签页

---

## ❓ 常见问题

### Q1: 部署后数据会丢失吗？
**A**: 
- Railway: 配置 Volume 后不会丢失
- Render: 配置 Disk 后不会丢失
- Vercel: 需要配置数据库

### Q2: 免费额度用完怎么办？
**A**: 
- Railway: 500小时/月，足够使用（约20天24小时运行）
- Render: 休眠机制，访问时自动唤醒
- 可以部署到多个平台备用

### Q3: 域名可以自定义吗？
**A**: 
- 免费版使用平台提供的域名
- 如需自定义域名，需购买域名并升级到付费计划（约$5/月）

### Q4: 如何更新代码？
**A**: 
只需推送到 GitHub：
```bash
git add .
git commit -m "更新内容"
git push origin main
```
Railway/Render 会自动重新部署！

### Q5: 国内访问慢怎么办？
**A**: 
- 使用腾讯云 CloudBase（国内）
- 或购买域名 + CDN 加速

---

## 🎯 我的推荐

### 对于你的项目（BBK数学答题王）

1. **首选：Railway**
   - 部署最简单
   - 数据持久化稳定
   - 500小时足够使用

2. **备选：Render**
   - 如果 Railway 额度不够
   - 750小时/月更充裕

3. **学习环境：Glitch**
   - 如果只是测试
   - 无需 Git 操作

---

## 📝 下一步

### 立即部署到 Railway

1. 访问：https://railway.app
2. 用 GitHub 登录
3. New Project → Deploy from GitHub
4. 选择仓库 → Deploy
5. 生成域名 → 完成！

**预计时间：5分钟**

---

## 🆘 需要帮助？

- Railway 文档：https://docs.railway.app
- Render 文档：https://render.com/docs
- 问题反馈：查看部署日志

---

**祝你部署成功！🎉**

有任何问题随时问我~
